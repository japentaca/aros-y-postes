<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cabeza de pelota de Pato</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #87CEEB;
            font-family: 'Segoe UI', sans-serif;
        }

        #controls {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 250px;
            background: rgba(0, 20, 40, 0.9);
            padding: 15px;
            border-radius: 8px;
            color: white;
            z-index: 20;
            max-height: 90vh;
            overflow-y: auto;
            transition: max-height 0.3s ease, padding 0.3s ease;
        }

        #controls.collapsed {
            max-height: 50px;
            overflow: hidden;
            padding-bottom: 15px;
        }

        #toggle-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            cursor: pointer;
            user-select: none;
        }

        #toggle-header h3 {
            margin: 0;
            color: #44aaff;
            border-bottom: 1px solid #44aaff;
            flex-grow: 1;
            padding-bottom: 5px;
        }

        #toggle-btn {
            background: none;
            border: none;
            color: #44aaff;
            font-size: 1.2em;
            cursor: pointer;
            transition: transform 0.3s ease;
            padding: 0 0 5px 10px;
            line-height: 1;
            margin-left: 10px;
        }

        #controls.collapsed #toggle-btn {
            transform: rotate(-90deg);
        }

        .controls-content {
            transition: opacity 0.3s ease;
        }

        #controls.collapsed .controls-content {
            opacity: 0;
            pointer-events: none;
        }

        #fps-counter {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.8);
            color: #00ff00;
            padding: 8px 12px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            font-weight: bold;
            z-index: 20;
            border: 1px solid #00ff00;
        }

        .control-group {
            margin-bottom: 10px;
        }

        label {
            display: flex;
            justify-content: space-between;
            font-size: 0.9em;
        }

        input[type="range"] {
            width: 100%;
            accent-color: #44aaff;
        }

        /* Toggle Switch */
        .switch {
            position: relative;
            display: inline-block;
            width: 40px;
            height: 20px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 20px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked+.slider {
            background-color: #44aaff;
        }

        input:checked+.slider:before {
            transform: translateX(20px);
        }

        #status {
            position: absolute;
            bottom: 20px;
            width: 100%;
            text-align: center;
            pointer-events: none;
            z-index: 10;
        }

        #status-pill {
            display: inline-block;
            background: rgba(0, 0, 0, 0.8);
            color: #ffff00;
            padding: 10px 20px;
            border-radius: 20px;
            font-family: monospace;
            font-size: 1.2em;
            border: 2px solid #ffff00;
        }
    </style>
</head>

<body>

    <div id="fps-counter">FPS: <span id="fps-value">0</span></div>

    <div id="controls">
        <div id="toggle-header">
            <h3>CONFIGURACIÓN</h3>
            <button id="toggle-btn" title="Colapsar/Expandir">▼</button>
        </div>
        <div class="controls-content">

            <div class="control-group">
                <label>
                    Modo Nocturno (Neon)
                    <label class="switch">
                        <input type="checkbox" id="chk-theme">
                        <span class="slider"></span>
                    </label>
                </label>
            </div>
            <div class="control-group">
                <label>Partículas <span id="v-fireflies">700</span></label>
                <input type="range" id="sl-fireflies" min="0" max="10000" step="100" value="700">
            </div>
            <!-- Checkbox de Mostrar Spline - Comentado visualmente pero funcional -->
            <div class="control-group" style="display: none;">
                <label>
                    Mostrar Spline Cámara
                    <label class="switch">
                        <input type="checkbox" id="chk-spline">
                        <span class="slider"></span>
                    </label>
                </label>
            </div>
            <div class="control-group">
                <label>Tipo de Curva (Spline)</label>
                <select id="sl-curveType"
                    style="width: 100%; margin-top: 5px; background: rgba(0,0,0,0.5); color: white; border: 1px solid #44aaff; padding: 5px; border-radius: 4px;">
                    <option value="centripetal">Centripetal (Suave)</option>
                    <option value="catmullrom">Catmull-Rom (Normal)</option>
                    <option value="chordal" selected>Chordal (Uniforme - Default)</option>
                </select>
            </div>
            <div class="control-group">
                <label>Velocidad <span id="v-speed">0.25</span></label>
                <input type="range" id="sl-speed" min="0.05" max="1.5" step="0.05" value="0.25">
            </div>

            <div class="control-group">
                <label>Altura Vuelo <span id="v-height">25</span></label>
                <input type="range" id="sl-height" min="10" max="100" step="5" value="25">
            </div>

            <hr style="border-color: #555;">

            <div class="control-group">
                <label>Terreno (m) <span id="v-terrain">300</span></label>
                <input type="range" id="sl-terrain" min="200" max="2000" step="100" value="300">
            </div>
            <div class="control-group">
                <label>Postes <span id="v-posts">20</span></label>
                <input type="range" id="sl-posts" min="3" max="100" step="1" value="20">
            </div>
            <div class="control-group">
                <label>Rivales <span id="v-balls">5</span></label>
                <input type="range" id="sl-balls" min="0" max="50" step="1" value="5">
            </div>
            <div class="control-group">
                <label>Distancia Punto Previo (m) <span id="v-preRingDistance">1</span></label>
                <input type="range" id="sl-preRingDistance" min="1" max="20" step="1" value="15">
            </div>
            <div class="control-group">
                <label>Altura Máxima Postes (m) <span id="v-maxPostHeight">10</span></label>
                <input type="range" id="sl-maxPostHeight" min="1" max="50" step="0.5" value="10">
            </div>
        </div>
    </div>

    <div id="status">
        <div id="status-pill">CARGANDO...</div>
    </div>

    <script type="importmap">
        {
            "imports": {
                "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
                "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
            }
        }
    </script>

    <script type="module" src="./js/Main.js"></script>

</body>

</html>